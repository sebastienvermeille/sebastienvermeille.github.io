<!DOCTYPE html>
<html lang="en">
<head>
	<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Step Builder - Design pattern | CookieCode</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Step Builder - Design pattern" />
<meta name="author" content="sbeex" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The StepBuilder pattern is a derivative of Builder pattern. You may never have heard about this pattern as it is not common to find it mentioned in books/articles about design patterns." />
<meta property="og:description" content="The StepBuilder pattern is a derivative of Builder pattern. You may never have heard about this pattern as it is not common to find it mentioned in books/articles about design patterns." />
<link rel="canonical" href="https://cookiecode.dev/design%20pattern/stepbuilder-pattern.html" />
<meta property="og:url" content="https://cookiecode.dev/design%20pattern/stepbuilder-pattern.html" />
<meta property="og:site_name" content="CookieCode" />
<meta property="og:image" content="https://cookiecode.dev/assets/images/articles/step-by-step-whats-next.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-06-09T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://cookiecode.dev/assets/images/articles/step-by-step-whats-next.jpg" />
<meta property="twitter:title" content="Step Builder - Design pattern" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"sbeex"},"dateModified":"2022-06-09T00:00:00+00:00","datePublished":"2022-06-09T00:00:00+00:00","description":"The StepBuilder pattern is a derivative of Builder pattern. You may never have heard about this pattern as it is not common to find it mentioned in books/articles about design patterns.","headline":"Step Builder - Design pattern","image":"https://cookiecode.dev/assets/images/articles/step-by-step-whats-next.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://cookiecode.dev/design%20pattern/stepbuilder-pattern.html"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://cookiecode.dev/assets/logo/png/logo.png"},"name":"sbeex"},"url":"https://cookiecode.dev/design%20pattern/stepbuilder-pattern.html"}</script>
<!-- End Jekyll SEO tag -->

	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="icon" href="/assets/logo/png/logo.png">
	<link href="/assets/css/main.css" rel="stylesheet">
	<link href="/assets/vendors/fontawesome/css/all.css" rel="stylesheet">
</head>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-08V6SWRTHK"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'G-08V6SWRTHK');
</script>


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4328681465012055"
		crossorigin="anonymous"></script>






<body class="layout-post sub-theme-concept">
<!--	&lt;!&ndash; defer loading of font and font awesome &ndash;&gt;-->
<!--	<noscript id="deferred-styles">-->
<!--		<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">-->
<!--	</noscript>-->

<nav class="navbar gradient-bg lavel" role="navigation" aria-label="main navigation">
	<div class="navbar-brand">
		
		<a class="navbar-item" href="/index.html">
			<img src="/assets/logo/png/logo.png" width="28" height="28" alt="CookieCode logo">
		</a>

		<a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbarBasicExample">
			<span aria-hidden="true"></span>
			<span aria-hidden="true"></span>
			<span aria-hidden="true"></span>
		</a>
	</div>
	<div id="navbar" class="navbar-menu is-unselectable">
		<div class="navbar-start">
			<a class="navbar-item " href="/blog/">
				Blog
			</a>

			<a class="navbar-item " href="/oss/">
				Open Source
			</a>

			<a class="navbar-item " href="/about/">
				About me
			</a>
		</div>

		<div class="navbar-end">
			<div class="navbar-item">
				<div class="buttons has-addons">
					<button class="button is-small" onclick="themeSwitch('light');">
                            <span class="icon is-small">
                            <i class="fas fa-sun"></i>
                          </span>
					</button>
					<button class="button is-small" onclick="themeSwitch('dark');">
                            <span class="icon is-small">
                            <i class="fas fa-moon"></i>
                          </span>
					</button>
				</div>
			</div>
		</div>
	</div>
</nav>
<label class="theme_changer" style="display:none;">
	<input theme_toggle type="checkbox" id="theme_toggle">
	<div class="button"></div>
</label>
<main>
	<section class="section columns">
    <div class="container column is-8">
        <div class="content">
            <h1 class="title gradient-text">Step Builder - Design pattern</h1>
            <figure class="image is-3by1">
                <img src="/assets/images/articles/step-by-step-whats-next.jpg" alt="Step Builder - Design pattern"/>
            </figure>
            <p>The <strong>StepBuilder</strong> pattern is a derivative of <a href="https://www.geeksforgeeks.org/builder-design-pattern/">Builder pattern</a>. 
You may never have heard about this pattern as it is not common to find it mentioned in books/articles about design patterns.</p>

<p>This design pattern is part of the <strong>object creation</strong> design pattern category.
It helps to create an instance of a class, but in a more assisted way than a builder would do.</p>

<h2 id="what-does-it-solve">What does it solve</h2>

<p>As opposite to a general builder, the step builder assist the developer providing guidance during the object creation.</p>

<p>Each steps declare the next step so that the developer can not do any mistake or forget some mandatory steps.
<img src="../assets/images/articles/step-by-step.jpg" alt="Going step by step" /></p>

<p>Here is an example using traditional builder for an email:</p>

<p><img src="../assets/images/articles/builder-pattern-weakness.png" alt="" /></p>

<p>As we can see in point <code class="language-plaintext highlighter-rouge">(1)</code> the autocomplete show us methods: <code class="language-plaintext highlighter-rouge">.withContent()</code>, <code class="language-plaintext highlighter-rouge">.withFrom()</code>, <code class="language-plaintext highlighter-rouge">.withTitle()</code>, <code class="language-plaintext highlighter-rouge">.withTo()</code> methods and <code class="language-plaintext highlighter-rouge">.build()</code> right after having invoked <code class="language-plaintext highlighter-rouge">.builder()</code>.</p>

<p>Which means that we could simply write the following code and have something perfectly fine regarding compilation:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="source-code"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="c1">// Example: Builder pattern weakness - can build empty objects</span>
<span class="kd">final</span> <span class="kt">var</span> <span class="n">email</span> <span class="o">=</span> <span class="nc">Email</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
  <span class="o">.</span><span class="na">build</span><span class="o">();</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Does it make sense to have an <code class="language-plaintext highlighter-rouge">Email</code> instance without any from, to properties set ? Not really…</p>

<div class="premonition question">
  <i class="premonition pn-square"></i>
  <div class="content">
    <p class="header">But the build() method could check for that and ensure that required fields are provided no ?</p><p>That’s perfectly right. But remember: <strong>it will only display the issue at runtime</strong>.</p>




  </div>
</div>

<p>Wouldn’t it be better if we could enforce a bit the autocomplete to provide only invokable methods ?</p>

<p>Step builder pattern address this issue:</p>

<p><img src="../assets/images/articles/step-builder-autocomplete-demo.gif" alt="" /></p>

<p>Using step builder pattern you no longer can forget to define <code class="language-plaintext highlighter-rouge">from</code>, <code class="language-plaintext highlighter-rouge">to</code>, <code class="language-plaintext highlighter-rouge">title</code>, <code class="language-plaintext highlighter-rouge">content</code> properties when creating an <code class="language-plaintext highlighter-rouge">Email</code> instance.
Furthermore the order is controlled. As you can see we can not call <code class="language-plaintext highlighter-rouge">.setContent()</code> method in the beginning. There is a sequence which define in which order each method can be called.</p>

<h2 id="cool-but-how-does-it-works-">Cool but how does it works ?</h2>

<p>The trick is to use a specific interface per step.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="source-code"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
</pre></td><td class="rouge-code"><pre><span class="c1">// Email.java - StepBuilder implementation</span>
<span class="nd">@Getter</span>
<span class="nd">@ToString</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Email</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">from</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">to</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">content</span><span class="o">;</span>

  <span class="kd">private</span> <span class="nf">Email</span><span class="o">(</span><span class="kd">final</span> <span class="nc">Builder</span> <span class="n">builder</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">from</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">from</span><span class="o">;</span>
    <span class="n">to</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">to</span><span class="o">;</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">title</span><span class="o">;</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">content</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="nc">IFrom</span> <span class="nf">builder</span><span class="o">()</span> <span class="o">{</span> <span class="c1">// (1) &lt;-- here we expect IFrom </span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">Builder</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IFrom</span> <span class="o">{</span> <span class="c1">// (2) &lt;-- IFrom declares ITo withFrom(String val)</span>
    <span class="nc">ITo</span> <span class="nf">withFrom</span><span class="o">(</span><span class="nc">String</span> <span class="n">val</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ITo</span> <span class="o">{</span> <span class="c1">// (3) &lt;-- ITo -&gt; ITitle -&gt; IContent</span>
    <span class="nc">ITitle</span> <span class="nf">withTo</span><span class="o">(</span><span class="nc">String</span> <span class="n">val</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ITitle</span> <span class="o">{</span> <span class="c1">// (4) &lt;-- ITitle -&gt; IContent </span>
    <span class="nc">IContent</span> <span class="nf">withTitle</span><span class="o">(</span><span class="nc">String</span> <span class="n">val</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IContent</span> <span class="o">{</span> <span class="c1">// (5) &lt;-- IContent -&gt; IBuild </span>
    <span class="nc">IBuild</span> <span class="nf">withContent</span><span class="o">(</span><span class="nc">String</span> <span class="n">val</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IBuild</span> <span class="o">{</span> <span class="c1">// (6) &lt;-- IBuild -&gt; Email instance! Woohoo :) </span>
    <span class="nc">Email</span> <span class="nf">build</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">Builder</span> <span class="kd">implements</span> <span class="nc">IContent</span><span class="o">,</span> <span class="nc">ITitle</span><span class="o">,</span> <span class="nc">ITo</span><span class="o">,</span> <span class="nc">IFrom</span><span class="o">,</span> <span class="nc">IBuild</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">content</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">to</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">from</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nf">Builder</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">IBuild</span> <span class="nf">withContent</span><span class="o">(</span><span class="kd">final</span> <span class="nc">String</span> <span class="n">val</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">content</span> <span class="o">=</span> <span class="n">val</span><span class="o">;</span>
      <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">IContent</span> <span class="nf">withTitle</span><span class="o">(</span><span class="kd">final</span> <span class="nc">String</span> <span class="n">val</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">title</span> <span class="o">=</span> <span class="n">val</span><span class="o">;</span>
      <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">ITitle</span> <span class="nf">withTo</span><span class="o">(</span><span class="kd">final</span> <span class="nc">String</span> <span class="n">val</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">to</span> <span class="o">=</span> <span class="n">val</span><span class="o">;</span>
      <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">ITo</span> <span class="nf">withFrom</span><span class="o">(</span><span class="kd">final</span> <span class="nc">String</span> <span class="n">val</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">from</span> <span class="o">=</span> <span class="n">val</span><span class="o">;</span>
      <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Email</span> <span class="nf">build</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nf">Email</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>This code can be written by hand but let’s be honest it would be much easier with a generator no ? Good news, a lot of generator exists for multiple IDE.</p>

<p>If you are using IntelliJ I suggest you this plugin that I maintain: <a href="https://plugins.jetbrains.com/plugin/16792-stepbuilder-codegen">stepbuilder-codegen</a>.</p>

<p>You can generate this code in a very few steps.</p>

<h2 id="conclusion">Conclusion</h2>
<p>As usual for design pattern you can find my example implementation <a href="https://github.com/sebastienvermeille/java-design-patterns/tree/main/step-builder">here</a>.</p>

<p>This pattern provide compile time issue when an object is not correctly constructed which is definitely a plus. 
I like the fluent coding style which render the code much more intuitive. This is like some UX design for developers using your API.</p>

<p>I see it as a quality when an API provide such way of using it. I was used to <code class="language-plaintext highlighter-rouge">Mockito</code> (a testing library for Java) which provide some fluent API too.</p>

<h2 id="references">References</h2>
<ul>
  <li><a href="https://plugins.jetbrains.com/plugin/16792-stepbuilder-codegen">IntelliJ plugin to generate StepBuilder</a>.</li>
  <li><a href="https://www.svlada.com/step-builder-pattern/">Svlada article</a></li>
  <li><a href="https://martinfowler.com/bliki/FluentInterface.html">Martin Fowler - FluentInterface</a></li>
</ul>

        </div>
    </div>
    <aside class="column is-3 is-narrow-mobile is-fullheight is-hidden-mobile">
        <div class="content has-text-centered is-unselectable">
            <img src="/assets/logo/logo.svg" width="225" height="225" alt="CookieCode logo" class="logo"/>
        </div>
        <nav class="panel is-unselectable">
            <p class="panel-heading is-size-6">
                Metadata
            </p>
            <div class="panel-block is-size-7">
                <span class="panel-icon">
                  <i class="fas fa-clock" aria-hidden="true"></i>
                </span>
                Reading time: ~6 minutes
            </div>
            <div class="panel-block is-size-7">
                <span class="panel-icon">
                  <i class="fas fa-calendar" aria-hidden="true"></i>
                </span>
                <time class="post-date" datetime="2022-06-09">Published: 2022/06/09</time>
            </div>

            

            <div class="panel-block is-clipped">
                
                <nav class="level is-mobile">
	<div class="level-left">
		<div class="field is-grouped is-grouped-multiline">
			
		</div>
	</div>
</nav>
            </div>
        </nav>
        <nav class="panel is-unselectable"><p class="panel-heading is-size-6">Sebastien Vermeille</p>
<div class="navbar-item is-size-7">
	Highly passionate programmer with an insatiable quest for knowledge. <br>Interested in Clean Code concepts, good practices, software
	architecture, emerging frameworks, <br>and also in electronics IoT, DIY projects.
</div>
<div class="panel-block">
	<a class="button is-link is-outlined is-fullwidth" href="/about">More about me</a>
</div>
</nav>
    </aside>
</section>

<section class="section">
    <div class="container">
        <div class="content"><section class="disqus">

    <div id="disqus_thread"></div>
    <script>
        /**
         *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
         *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
        /*
        var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        };
        */
        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');
            var disqus_shortname = '';
            s.src = 'https://cookiecode-dev.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>
</div>
    </div>
</section>

<section class="section">
    <h1 class="title gradient-text">Discover more articles...</h1>
    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
        
        <a class="pagination-previous" href="//tools/git-ignore-io.html"> &laquo; Gitignore.io - Generate your gitignore files in seconds!</a>
        
        
        <a class="pagination-next" href="//linux/Bind-flameshot-to-printscr-i3wm.html">[Howto] Bind PrtScr key in i3wm with Falmeshot to take screenshots &raquo; </a>
        
    </nav>
</section>

</main>

<footer class="footer">
	<div class="footer-top"></div>

	<div class="container">
		<div class="is-hidden-tablet">
			<span class="select is-fullwidth">
				<select id="destination-selector">
					<option value="">Choose a category ...</option>
					<optgroup label="Languages">Languages</optgroup>
					<option value="/categories/java/index.html">JAVA</option>
					<optgroup label="Tooling">Tooling</optgroup>
					<option value="/categories/unraid/index.html">Unraid</option>
					<option value="/categories/iot/index.html">IoT</option>
					<optgroup label="Concepts">Concepts</optgroup>
					<option value="/categories/design-pattern/index.html">Design pattern</option>
				</select>
			</span>
		</div>

		<div class="columns is-hidden-mobile">
			<div class="column">
				Languages
				<ul>
					<li>
						<a href="/categories/java/index.html" class="item">JAVA</a>
					</li>
					
				</ul>
			</div>
			<div class="column">
				Tooling
				<ul>
					
					<li>
						<a href="/categories/unraid/index.html" class="item">Unraid</a>
					</li>
					<li>
						<a href="/categories/iot/index.html" class="item">IoT</a>
					</li>
				</ul>
			</div>
			<div class="column">
				Concepts
				<ul>
					
					<li>
						<a href="/categories/design-pattern/index.html" class="item">Design pattern</a>
					</li>
					
				</ul>
			</div>
		</div>
	</div>


	<div class="separator-line"></div>

	<div class="content has-text-centered">
		<p>
			<strong>CookieCode</strong> <a href="https://github.com/sebastienvermeille/sebastienvermeille.github.io/tree/master"
												target="_blank">source code</a> is licensed
			<a href="https://opensource.org/licenses/mit-license.php" target="_blank">MIT</a>. The website content (articles in markdown
			files, logo)
			are licensed <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY NC SA 4.0</a>.
		</p>
	</div>
</footer>

<script src="/assets/js/jquery.min.js"></script>
<script src="/assets/js/theme-switcher.js"></script>
<script src="/assets/js/theme.js"></script>
<script src="/assets/js/quotes.js"></script>


<!--    <script src="/assets/js/source-code-fancier.js"></script>-->

<!---->
<!--<script id="dsq-count-scr" src="//.disqus.com/count.js"></script>-->
<!---->

</body>
</html>
